<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>

    <title>Dominator.js @ github.com/mwbrooks</title>

    <link rel="stylesheet" type="text/css" href="style/dejavu-sans-mono/stylesheet.css" />
    <link rel="stylesheet" type="text/css" href="style/main.css" />

</head>

<body>
    <article>
        <header>
<pre>
<code>
dominator.open('#home')
         .click('a.redButton')
         .waitForPage('#boom')
         .destroy();
</code>
</pre>
        </header>

        <section id="synopsis">
            <h1>Synopsis</h1>
            <p>Dominator adds <a href="http://en.wikipedia.org/wiki/Functional_testing">functional test</a> assertions to <a href="http://docs.jquery.com/Qunit">QUnit</a>.</p>
            <p>Functional tests should be <a href="#example_tests">simple to write, easy to read</a>, and <a href="#customizing">adaptable</a> to any JavaScript framework.</p>
            <p>For us, functional tests are a smoke screen. When you need more, then it is time to abstract and unit test.</p>
        </section>

        <section id="example">
            <h1>Quick Example</h1>
            <p>Here is a QUnit project using Dominator:</p>
<pre>
<code>
<span class="comment">&lt;!-- test framework (load QUnit first) --&gt;</span>
&lt;script type="text/javascript" src="qunit.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript" src="dominator.js"&gt;&lt;/script&gt;

<span class="comment">&lt;!-- load application to test (optional) --&gt;</span>
&lt;script type="text/javascript"&gt;
    dominator.load({
        src:         '../index.html',
        id:          'app',
        name:        'app',
        width:       '320',
        height:      '480',
        scrolling:   'auto',
        frameborder: '0'
    });
&lt;/script&gt;

<span class="comment">&lt;!-- tests --&gt;</span>
&lt;script type="text/javascript" src="tests.js"&gt;&lt;/script&gt;
</code>
</pre>
            <p>and the QUnit assertions in tests.js:</p>
<pre id="example_tests">
<code>
module('open');

test('should open first page', function() {
    dominator.open('#home')
             .waitForPage('#home')
             .destroy();
});

module('settings');

test('should save settings', function() {
    dominator.open('#settings')
             .click('#save')
             .waitForEvent('document', 'settingsChange');
             .destroy();
});
</code>
</pre>
        </section>

        <section id="downloading">
            <h1>Downloading</h1>
            <p>
                <a href="http://github.com/mwbrooks/dominator.js/zipball/master" class="zip"></a>
                <a href="http://github.com/mwbrooks/dominator.js/tarball/master" class="tar"></a>
            </p>
        </section>

        <section id="installing">
            <h1>Installing</h1>
            <h2>Dominator</h2>
<pre>
<code>
<span class="comment">&lt;!-- include dominator.js after qunit.js --&gt;</span>
&lt;script type="text/javascript" src="qunit.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript" src="dominator.js"&gt;&lt;/script&gt;
</code>
</pre>
            <h2>Custom Dominators</h2>
<pre>
<code>
<span class="comment">&lt;!-- include custom dominators after dominator.js --&gt;</span>
&lt;script type="text/javascript" src="qunit.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript" src="dominator.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript" src="dominator.jqtouch.js"&gt;&lt;/script&gt;
</code>
</pre>
        </section>

        <section id="getting-started">
            <h1>Getting Started</h1>
            <h2>Download QUnit</h2>
            <p>Download <a href="http://docs.jquery.com/Qunit">QUnit</a> from <a href="http://github.com/jquery/qunit">github.com/jquery/qunit</a>.</p>
            <hr/>
            <h2>Download Dominator.js</h2>
            <p>Go to the <a href="#downloading">Downloading section</a>.</p>
            <hr/>
            <h2>File Structure</h2>
            <p>Feel free to keep your current application file structure. However, let's assume you are using something like this:</p>
<pre>
<code>
<span class="comment">
app/ ................... 
app/index.html ......... Web application
app/test/ .............. 
app/test/index.html .... Test runner
app/test/dominator/ .... Dominator.js
app/test/qunit/ ........ QUnit
app/test/tests/ ........ QUnit tests
</span>
</code>
</pre>
            <hr/>
            <h2>Create a Test Page</h2>
            <p>In /app/test/index.html:</p>
<pre>
<code>
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;link rel="stylesheet" type="text/css" href="qunit/qunit.css" /&gt;

  <span class="comment">&lt;!-- test framework (load qUnit first) --&gt;</span>
  &lt;script type="text/javascript" src="qunit/qunit.js"&gt;&lt;/script&gt;
  &lt;script type="text/javascript" src="dominator/dominator.js"&gt;&lt;/script&gt;

  <span class="comment">&lt;!-- load application to test --&gt;</span>
  &lt;script type="text/javascript"&gt;
    dominator.load({
        src:         '../index.html',
        id:          'app',
        name:        'app',
        width:       '320',
        height:      '480',
        scrolling:   'auto',
        frameborder: '0'
    });
  &lt;/script&gt;

  <span class="comment">&lt;!-- tests --&gt;</span>
  &lt;script type="text/javascript" src="tests/home.test.js"&gt;&lt;/script&gt;
  &lt;script type="text/javascript" src="tests/settings.test.js"&gt;&lt;/script&gt;

  &lt;title&gt;App Tests&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;h1 id="qunit-header"&gt;App Tests&lt;/h1&gt;
  &lt;h2 id="qunit-banner"&gt;&lt;/h2&gt;
  &lt;div id="qunit-testrunner-toolbar"&gt;&lt;/div&gt;
  &lt;h2 id="qunit-userAgent"&gt;&lt;/h2&gt;
  &lt;ol id="qunit-tests"&gt;&lt;/ol&gt;
  &lt;div id="qunit-fixture"&gt;
    <span class="comment">&lt;!-- populated dynamically --&gt;</span>
  &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code>
</pre>
            <hr/>
            <h2>Write Tests</h2>
            <p>In /app/test/tests/home.test.js:</p>
<pre>
<code>
module('open');

test('should open home page', function() {
    dominator.open('#home')
             .waitForPage('#home')
             .destroy();
});

test('should have a logo', function() {
    dominator.open('#home')
             .waitForVisible('#home .logo')
             .destroy();
});
</code>
</pre>
            <p>In /app/test/tests/settings.test.js:</p>
<pre>
<code>
module('settings');

test('should save settings', function() {
    dominator.open('#settings')
             .click('#save')
             .waitForEvent('document', 'settingsChange');
             .destroy();
});
</code>
</pre>

            <hr/>
            <h2>Run Tests</h2>
            <p>Dominator assertions are chainable and executed with <code>destroy();</code></p>
            <p>Open /app/test/index.html</p>
            <hr/>
            <h2>Manually Loading the App to Test (optional)</h2>
            <p>If the default <code>dominator.load</code> implementaton is not doing it for you, then you can override it or not use it.</p>
            <p>Just remember that Dominator disables QUnit's auto-run, so that you can wait for your application to load.</p>
<pre>
<code>
// After loading the test and application
// you can safely start QUnit with:
QUnit.start();
</code>
</pre>
            <p>You could override the application loader like this:</p>
<pre>
<code>
dominator.fn.load = function(some, custom, params) {

    // do whatever you need to load the application

    dominator.config.window = myApplicationWindow;

    QUnit.start();
};
</code>
</pre>
        </section>

        <section id="reference">
            <h1>Reference</h1>

            <h2 id="application-loader">Application Loader</h2>
            <p>An optional helper function to load the test application.</p>
<pre>
<code>
//
// Convenience function to load an application into an &lt;iframe /&gt;
//
// Can be called before or after adding the QUnit tests.
//
// - Sets dominator.config.window
// - Calls QUnit.start(); after the application has loaded
//
// @param options {Object} attributes to add to the &lt;iframe /&gt;
//
dominator.load({
    src:         '../index.html',
    id:          'app',
    name:        'app',
    width:       '320',
    height:      '480',
    scrolling:   'auto',
    frameborder: '0'
});
</code>
</pre>
            <h2>Assertions</h2>
            <p>Here are the cold, mechanical limbs of the dominator:</p>
<pre>
<code>
dominator.open('#home')

dominator.click('#home a.button')

dominator.waitForVisible('#home .notification')

dominator.waitForNotVisible('#home .error')

dominator.waitForEvent('#home a.button', 'touchend')

dominator.waitForPage('#settings')
</code>
</pre>
            <h2>About Chaining</h2>
            <p>Assertions are queued and executed with <code>destroy();</code>:</p>
<pre>
<code>
// Does nothing, but tries to run all queued assertions
dominator.destroy();

// Asserts that home page opened
dominator.open('#home')
         .destroy();

// Asserts that:
//   - home page opened
//   - a button inside the home page was clicked
dominator.open('#home')
         .click('#home a.button')
         .destroy();

// Same as above
dominator.open('#home');
dominator.click('#home a.button');
dominator.destroy();
</code>
</pre>
        </section>

        <section id="customizing">
            <h1>Customizing</h1>
            <p>Every application is structured different.</p>
            <p>This is why Dominator was designed for customization.</p>
            <p>Feel free to override any existing assertion and add your own.</p>
            <h2>Extend</h2>
<pre>
<code>
//
// Add and Override Assertions
//
// Add your arguments that you need, such as `id`.
// The final argument must be a callback function.
// Call the callback when your assertion is complete.
//
// This example adds `dominator.tap("body a.button");`
// and uses the XUI JavaScript library.
//
dominator.extend('tap', function(id, callback) {
    this.window.x$(id).trigger('mousedown');
    callback();
});
</code>
</pre>
            <h2>Window</h2>
<pre>
<code>
//
// Window Handle of Test Application
//
// While testing, you will need a handle to the
// application window.
//
// The window value is set before running QUnit.start() with:
//    dominator.config.window = window;
//
dominator.extend('tap', function(id, callback) {
    this.window.x$(id).trigger('tap');
    callback();
});
</code>
</pre>
            <h2>Expect</h2>
<pre>
<code>
//
// Expect an Assertion Count
//
// Tells QUnit how many assertions should fire.
//
// Typically, expect is used within extend.
//
// Expect will auto-increment the existing
// expectation count, so there is no need to worry
// about clobbering a preset value.
//
dominator.extend('tap', function(id, callback) {
    // 'tap' should fire on positive assertion
    this.expect(1);

    // 'tap' requires at least one tappable element
    if (x$(id).length > 0) ok(true, 'found at least one ' + id);

    x$(id).trigger('mousedown');
    callback();
});
</code>
</pre>
            <h2>Config</h2>
            <p>The Dominator configuration is stored in <code>dominator.config</code>:</p>
<pre>
<code>
// window {Object}
//
// The window handle to the test application.
// This must be set before calling QUnit.start();
//
// This value is used by all Dominator assertions.
//
// See the Reference section for more detail.
//
dominator.config.window = DOMElement;

// Feel free to pass any property or function
// that you extensions may need
//
// For example:
//
dominator.config.postResults = function(value) {
    // XHR POST results to a server
};
</code>
</pre>
            <h2>Fn</h2>
            <p>Extend the dominator prototype:</p>
<pre>
<code>
// Override Application Loader
//   dominator.load({});
//
dominator.fn.load = function(options) {
    // implementation
};

// Create Something New
//   dominator.beep();
//
dominator.fn.beep = function() {
    console.log('BOOM!!!');
};
</code>
</pre>
        </section>

        <section id="community">
            <h1>Community</h1>
            <h2>Google Groups</h2>
            <p>Please use the <a href="http://groups.google.com/group/phonegap">PhoneGap Google Group</a>.</p>
            <h2>IRC</h2>
            <p>Jump onto <a href="irc://irc.freenode.net/phonegap">#phonegap @ irc.free.node</a> and look for <a href="http://github.com/mwbrooks">mwbrooks</a></p>
            <h2>Direct Message</h2>
            <p>Contact <a href="https://github.com/inbox/new/mwbrooks">Michael Brooks</a> through a GitHub message.</p>
        </section>

        <section id="contribute">
            <h1>Contribute</h1>
            <h2>Improvements</h2>
            <p>Help me out by using the <a href="https://github.com/mwbrooks/dominator.js/issues">GitHub Issue Tracker</a> to report a bug and discuss changes.</p>
            <hr/>
            <h2>Pull Requests</h2>
            <p>I appreciate pull requests!</p>
            <p>I appreciate them more when on topic branch, instead of the master branch.</p>
            <hr/>
            <h2>Everything else</h2>
            <p>Here are a few ideas:</p>
            <ul>
                <li>Minor Web design tweaks</li>
                <li>Documentation</li>
                <li>Usage feeback</li>
            </ul>
        </section>

        <section id="acknowledgement">
            <h1>Acknowledgement</h1>
            <ul>
                <li><a href="http://nitobi.com/">Nitobi</a> guys for running the library through the dirt</li>
                <li><a href="http://www.explodingdog.com/">Sam Brown</a> for the <a href="http://www.explodingdog.com/redrobot/">Red Robot</a> image</li>
            </ul>
        </section>

        <section id="license">
            <h1>License</h1>
            <p><a href="https://github.com/mwbrooks/dominator.js/blob/master/LICENSE">The MIT License</a></p>
        </section>

        <footer>
        </footer>
    </article>

    <a href="http://github.com/mwbrooks/dominator.js">
        <img style="position: absolute; top: 0; left: 0; border: 0;" src="style/image/ribbon.png" alt="Fork me on GitHub">
    </a>

    <script type="text/javascript">
        var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
        document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
        try {
            var pageTracker = _gat._getTracker("UA-21515431-1");
            pageTracker._trackPageview();
        } catch(err) {}
    </script>
    <script type="text/javascript" src="js/hijs.js"></script>
</body>
</html>
